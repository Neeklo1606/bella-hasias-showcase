import{a2 as I,r as i,j as e,L as u,a0 as k,a1 as A,d as M,s as D}from"./index-SoIpdMiX.js";import{u as E}from"./use-resolved-media-CME_U08d.js";import{A as p}from"./arrow-left-Cqd7CBo7.js";import{I as L}from"./image-B6N2rTep.js";const B=r=>/\.(mp4|webm)$/i.test(r)||r.startsWith("data:video/")||r.startsWith("http")&&/\.(mp4|webm)/i.test(r),H=()=>{const{slug:r}=I(),[t,f]=i.useState(null),[n,h]=i.useState(null),[g,j]=i.useState([]),[v,c]=i.useState(!0),[o,d]=i.useState(null);i.useEffect(()=>{(async()=>{var x;if(!r){d("Slug не указан"),c(!1);return}try{c(!0);const[l,w]=await Promise.all([M.getBySlug(r),D.list({per_page:100})]);if(f(l),l.serviceId){const a=w.data.find(S=>S.id===l.serviceId);h(a||null)}const y=l.media||[];j(y.map(a=>({id:String(a.id),filename:a.filename,src:a.url||a.src,category:a.category||"Прочее",alt:a.alt||"",createdAt:a.createdAt||new Date().toISOString()})))}catch(l){console.error("Failed to load case:",l),d(((x=l.response)==null?void 0:x.status)===404?"Кейс не найден":"Ошибка загрузки")}finally{c(!1)}})()},[r]);const N=E(g),b=new Map(N.map(s=>[s.id,s]));if(v)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Загрузка..."})});if(o||!t)return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center px-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:o||"Кейс не найден"}),e.jsxs(u,{to:"/portfolio",className:"mt-4 text-primary hover:underline flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),"Назад к портфолио"]})]});const m=t.mediaIds.map(s=>b.get(s)).filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsxs(k,{children:[e.jsxs("title",{children:[t.title," — Bella Hasias | Портфолио"]}),e.jsx("meta",{name:"description",content:t.description.slice(0,160)})]}),e.jsxs("main",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"mx-auto max-w-4xl px-4 py-12 md:px-6",children:[e.jsxs(u,{to:"/portfolio",className:"mb-8 inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(p,{className:"h-4 w-4"}),"Назад к портфолио"]}),e.jsxs("header",{className:"mb-10",children:[n&&e.jsx("p",{className:"text-sm font-medium text-primary mb-2",children:n.title}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight md:text-4xl",children:t.title}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:t.tags.map(s=>e.jsx("span",{className:"rounded-full bg-secondary px-3 py-1 text-sm text-muted-foreground",children:s},s))})]}),t.description&&e.jsx("div",{className:"prose prose-neutral dark:prose-invert max-w-none mb-12",children:e.jsx("p",{className:"whitespace-pre-wrap text-muted-foreground leading-relaxed",children:t.description})}),e.jsxs("section",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Галерея"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:m.map(s=>e.jsx("div",{className:"overflow-hidden rounded-2xl bg-muted aspect-[4/3]",children:B(s.src)?e.jsx("video",{src:s.src,controls:!0,className:"h-full w-full object-cover"}):e.jsx("img",{src:s.src,alt:s.alt||t.title,className:"h-full w-full object-cover"})},s.id))}),m.length===0&&e.jsx("div",{className:"flex aspect-video items-center justify-center rounded-2xl border border-dashed bg-muted/30",children:e.jsx(L,{className:"h-16 w-16 text-muted-foreground/50"})})]})]}),e.jsx(A,{})]})]})};export{H as default};
