import{c as X,r as h,v as Y,C as ce,j as e,P as J,w as le,D as de,y as me,b as M,T as he,B as S,E,F as U,G as L,f as ue,g as I,d as pe,h as q,H as D,t as A,m as xe}from"./index-CI0f139K.js";import{u as P}from"./useMutation-CCmO4xG4.js";import{I as R}from"./input-nocTXNVk.js";import{L as C}from"./label-McPTSBzc.js";import{C as F,a as B,c as H,e as G,b as z}from"./card-qb64L33Q.js";import{T as fe}from"./popover-C5X4UALQ.js";import{u as ge,L as ye,S as ve}from"./index-C22GVaKQ.js";import{M as je}from"./MediaSelect-CawXMq7Y.js";import{E as O}from"./external-link-D2tCoYyJ.js";import{u as be}from"./use-resolved-media-DTLTwVzt.js";import"./image-PnmKth2L.js";import"./check-CD1yboqe.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=X("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=X("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var k="Switch",[we]=me(k),[Se,Ne]=we(k),V=h.forwardRef((s,r)=>{const{__scopeSwitch:n,name:d,checked:t,defaultChecked:i,required:c,disabled:l,value:a="on",onCheckedChange:p,form:m,...x}=s,[u,g]=h.useState(null),y=Y(r,N=>g(N)),v=h.useRef(!1),b=u?m||!!u.closest("form"):!0,[f,w]=ce({prop:t,defaultProp:i??!1,onChange:p,caller:k});return e.jsxs(Se,{scope:n,checked:f,disabled:l,children:[e.jsx(J.button,{type:"button",role:"switch","aria-checked":f,"aria-required":c,"data-state":se(f),"data-disabled":l?"":void 0,disabled:l,value:a,...x,ref:y,onClick:le(s.onClick,N=>{w(T=>!T),b&&(v.current=N.isPropagationStopped(),v.current||N.stopPropagation())})}),b&&e.jsx(te,{control:u,bubbles:!v.current,name:d,value:a,checked:f,required:c,disabled:l,form:m,style:{transform:"translateX(-100%)"}})]})});V.displayName=k;var Z="SwitchThumb",ee=h.forwardRef((s,r)=>{const{__scopeSwitch:n,...d}=s,t=Ne(Z,n);return e.jsx(J.span,{"data-state":se(t.checked),"data-disabled":t.disabled?"":void 0,...d,ref:r})});ee.displayName=Z;var Ce="SwitchBubbleInput",te=h.forwardRef(({__scopeSwitch:s,control:r,checked:n,bubbles:d=!0,...t},i)=>{const c=h.useRef(null),l=Y(c,i),a=ge(n),p=de(r);return h.useEffect(()=>{const m=c.current;if(!m)return;const x=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(x,"checked").set;if(a!==n&&g){const y=new Event("click",{bubbles:d});g.call(m,n),m.dispatchEvent(y)}},[a,n,d]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...t,tabIndex:-1,ref:l,style:{...t.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});te.displayName=Ce;function se(s){return s?"checked":"unchecked"}var ae=V,ke=ee;const re=h.forwardRef(({className:s,...r},n)=>e.jsx(ae,{className:M("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",s),...r,ref:n,children:e.jsx(ke,{className:M("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));re.displayName=ae.displayName;const W=60,Q=160,Te=({page:s,mediaItems:r,onSave:n,publicPath:d})=>{const t=s.seo??{metaTitle:"",metaDescription:"",index:!0},[i,c]=h.useState(t.metaTitle),[l,a]=h.useState(t.metaDescription),[p,m]=h.useState(t.ogImageId??""),[x,u]=h.useState(t.index);h.useEffect(()=>{c(t.metaTitle),a(t.metaDescription),m(t.ogImageId??""),u(t.index)},[s.id,t.metaTitle,t.metaDescription,t.ogImageId,t.index]);const g=()=>{n({metaTitle:i.trim(),metaDescription:l.trim(),ogImageId:p||void 0,index:x})},y=i.length,v=l.length,b=y<=W,f=v<=Q;return e.jsx(he,{children:e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:s.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(O,{className:"mr-1 h-3 w-3"}),"На сайте"]})}),e.jsx(S,{size:"sm",onClick:g,children:"Сохранить"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{htmlFor:`metaTitle-${s.id}`,children:"Meta Title"}),e.jsxs(E,{children:[e.jsx(U,{asChild:!0,children:e.jsx($,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(L,{className:"max-w-xs",children:"Заголовок для поисковой выдачи. Рекомендуется до 60 символов."})]}),e.jsxs("span",{className:`ml-auto text-xs ${b?"text-muted-foreground":"text-destructive"}`,children:[y,"/",W]})]}),e.jsx(R,{id:`metaTitle-${s.id}`,value:i,onChange:w=>c(w.target.value),placeholder:"Заголовок страницы | Bella Hasias",className:b?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{htmlFor:`metaDesc-${s.id}`,children:"Meta Description"}),e.jsxs(E,{children:[e.jsx(U,{asChild:!0,children:e.jsx($,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(L,{className:"max-w-xs",children:"Описание для сниппета в поиске. Рекомендуется до 160 символов."})]}),e.jsxs("span",{className:`ml-auto text-xs ${f?"text-muted-foreground":"text-destructive"}`,children:[v,"/",Q]})]}),e.jsx(fe,{id:`metaDesc-${s.id}`,value:l,onChange:w=>a(w.target.value),placeholder:"Краткое описание страницы для поисковых систем",rows:2,className:f?"":"border-destructive"})]}),e.jsx(je,{label:"OG Image",value:p,onChange:m,items:r,allowEmpty:!0}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{htmlFor:`index-${s.id}`,children:"Индексация"}),e.jsxs(E,{children:[e.jsx(U,{asChild:!0,children:e.jsx($,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(L,{className:"max-w-xs",children:"index — страница в поиске. noindex — не индексировать."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${x?"text-green-600":"text-amber-600"}`,children:x?"index":"noindex"}),e.jsx(re,{id:`index-${s.id}`,checked:x,onCheckedChange:u})]})]})]})})},Ee="https://bellahasias.ru",Ue={siteUrl:Ee},Le="cms_seo_config",oe=()=>{try{const s=localStorage.getItem(Le);if(s){const r=JSON.parse(s);if(r!=null&&r.siteUrl)return r}}catch{}return Ue},Ie={home:"/",contacts:"/contacts",portfolio:"/portfolio",services:"/services"},qe=[{path:"/services",priority:.9,changefreq:"weekly"},{path:"/portfolio",priority:.8,changefreq:"weekly"},{path:"/privacy",priority:.3,changefreq:"yearly"},{path:"/terms",priority:.3,changefreq:"yearly"},{path:"/consent",priority:.3,changefreq:"yearly"},{path:"/services/brand-styling",priority:.6,changefreq:"monthly"},{path:"/services/wardrobe-audit",priority:.6,changefreq:"monthly"},{path:"/services/personal-shopping",priority:.6,changefreq:"monthly"},{path:"/services/capsule-wardrobe",priority:.6,changefreq:"monthly"},{path:"/services/event-look",priority:.6,changefreq:"monthly"},{path:"/services/client-shoot",priority:.6,changefreq:"monthly"},{path:"/services/ugc",priority:.6,changefreq:"monthly"},{path:"/services/photo-video",priority:.6,changefreq:"monthly"},{path:"/services/ai-content",priority:.6,changefreq:"monthly"}],$e=(s,r,n)=>{var l;const t=oe().siteUrl.replace(/\/$/,""),i=a=>new Date(a).toISOString().slice(0,10),c=[];for(const a of s){if(((l=a.seo)==null?void 0:l.index)===!1)continue;const p=Ie[a.slug]??`/${a.slug}`,m=i(a.updatedAt),x=a.slug==="home"?"1.0":"0.8",u=a.slug==="home"?"weekly":"monthly";c.push(`  <url>
    <loc>${t}${p}</loc>
    <lastmod>${m}</lastmod>
    <changefreq>${u}</changefreq>
    <priority>${x}</priority>
  </url>`)}for(const a of r)c.push(`  <url>
    <loc>${t}/portfolio/${a.slug}</loc>
    <lastmod>${i(a.updatedAt)}</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.7</priority>
  </url>`);for(const a of qe)c.some(p=>p.includes(`<loc>${t}${a.path}</loc>`))||c.push(`  <url>
    <loc>${t}${a.path}</loc>
    <lastmod>${i(new Date().toISOString())}</lastmod>
    <changefreq>${a.changefreq}</changefreq>
    <priority>${a.priority}</priority>
  </url>`);return`<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
${c.join(`
`)}
</urlset>`},Re=(s,r)=>{const n=$e(s,r),d=new Blob([n],{type:"application/xml"}),t=URL.createObjectURL(d),i=document.createElement("a");i.href=t,i.download="sitemap.xml",i.click(),URL.revokeObjectURL(t)},Oe={home:"/",contacts:"/contacts",portfolio:"/portfolio",services:"/services"},_e=(s,r)=>{var c;const d=oe().siteUrl.replace(/\/$/,""),t=["/admin","/admin/"];for(const l of s)if(((c=l.seo)==null?void 0:c.index)===!1){const a=Oe[l.slug]??`/${l.slug}`;a!=="/"&&t.push(a)}return["User-agent: *","Allow: /",...t.map(l=>`Disallow: ${l}`),"",`Sitemap: ${d}/sitemap.xml`,`Host: ${d}`].join(`
`)},Me=s=>{const r=_e(s),n=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(n),t=document.createElement("a");t.href=d,t.download="robots.txt",t.click(),URL.revokeObjectURL(d)},De="https://search.google.com/test/rich-results",Ae="https://webmaster.yandex.ru/",Ve=()=>{const s=ue(),[r,n]=h.useState(""),[d,t]=h.useState(""),i={per_page:100},{data:c,isLoading:l}=I({queryKey:["pages","admin",i],queryFn:()=>A.adminList(i),refetchOnWindowFocus:!1,retry:1}),{data:a,isLoading:p}=I({queryKey:["media","admin",i],queryFn:()=>xe.adminList(i),refetchOnWindowFocus:!1,retry:1}),{data:m,isLoading:x}=I({queryKey:["seo","admin"],queryFn:()=>D.adminGet(),refetchOnWindowFocus:!1,retry:1}),u=(c==null?void 0:c.data)||[],g=(a==null?void 0:a.data)||[];m!=null&&m.siteUrl;const y=l||p||x;h.useEffect(()=>{m!=null&&m.siteUrl&&t(m.siteUrl)},[m]);const v=P({mutationFn:({pageId:o,seo:j})=>A.adminUpdate(o,{seo:j}),onSuccess:()=>{s.invalidateQueries({queryKey:["pages","admin"]}),q.success("SEO настройки страницы обновлены")}}),b=P({mutationFn:o=>D.adminUpdate({siteUrl:o}),onSuccess:()=>{s.invalidateQueries({queryKey:["seo","admin"]}),q.success("URL сайта обновлён")}}),f=(o,j)=>{v.mutate({pageId:Number(o),seo:j})},w=()=>{b.mutate(d.trim()||"https://bellahasias.ru")},N=async()=>{try{const o=await pe.adminList({per_page:100});Re(u,o.data),q.success("Sitemap.xml скачан")}catch{}},T=()=>{Me(u)},ne=be(g),_=h.useMemo(()=>{if(!r.trim())return u;const o=r.trim().toLowerCase();return u.filter(j=>j.title.toLowerCase().includes(o)||j.slug.toLowerCase().includes(o))},[u,r]),ie=o=>o.slug==="home"?"/":`/${o.slug}`;return y?e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx(ye,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("div",{className:"text-sm text-muted-foreground ml-3",children:"Загрузка SEO данных..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"SEO"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Мета-информация страниц, sitemap и robots.txt"})]}),e.jsxs(F,{children:[e.jsxs(B,{children:[e.jsx(H,{children:"URL сайта"}),e.jsx(G,{children:"Базовый URL для sitemap.xml и robots.txt"})]}),e.jsxs(z,{className:"flex flex-col gap-4 sm:flex-row sm:items-end",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(C,{htmlFor:"siteUrl",children:"Site URL"}),e.jsx(R,{id:"siteUrl",value:d,onChange:o=>t(o.target.value),placeholder:"https://your-site.com"})]}),e.jsx(S,{onClick:w,children:"Сохранить"})]})]}),e.jsxs(F,{children:[e.jsxs(B,{children:[e.jsx(H,{children:"Генерация файлов"}),e.jsx(G,{children:"Скачайте sitemap.xml и robots.txt и поместите в папку public/"})]}),e.jsxs(z,{className:"flex flex-wrap gap-4",children:[e.jsxs(S,{variant:"outline",onClick:N,children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Скачать sitemap.xml"]}),e.jsxs(S,{variant:"outline",onClick:T,children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Скачать robots.txt"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(R,{placeholder:"Поиск по странице...",value:r,onChange:o=>n(o.target.value),className:"pl-9 max-w-md"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:De,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(O,{className:"mr-1 h-3 w-3"}),"Google Rich Results"]})}),e.jsx(S,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:Ae,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(O,{className:"mr-1 h-3 w-3"}),"Яндекс Вебмастер"]})})]})]}),e.jsx("div",{className:"space-y-4",children:_.map(o=>e.jsx(Te,{page:o,mediaItems:ne,onSave:j=>f(o.id,j),publicPath:ie(o)},o.id))}),_.length===0&&e.jsx("p",{className:"py-8 text-center text-sm text-muted-foreground",children:u.length===0?"Нет страниц. Добавьте страницы в разделе Страницы.":"Нет результатов по поиску."})]})};export{Ve as default};
