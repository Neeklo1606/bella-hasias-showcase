import{u as S,a as C,r as s,j as e,B as E}from"./index-DVNSKH1R.js";import{D as L,a as R,b as A,c as I,d as k,I as j}from"./input-CGu_Z_I2.js";import{L as b}from"./label-CzXa1GQi.js";const M=()=>{const o=S(),{login:v,isAuthenticated:u,isAdmin:d,isReady:m}=C(),t=s.useRef(!1),n=s.useRef(!1),[p,y]=s.useState(""),[h,w]=s.useState(""),[f,c]=s.useState(null),[l,i]=s.useState(!1);s.useEffect(()=>{n.current||t.current||m&&u&&d&&!l&&(t.current=!0,o("/admin/dashboard",{replace:!0}))},[u,d,m,l,o]);const D=async a=>{var x,g;a.preventDefault(),c(null),i(!0),n.current=!1,t.current=!1;try{const r=await v(p.trim(),h);if(!r.ok){c(r.error??"Ошибка авторизации."),i(!1);return}n.current=!0,i(!1),setTimeout(()=>{t.current=!0,n.current=!1,o("/admin/dashboard",{replace:!0})},200)}catch(r){const N=((g=(x=r.response)==null?void 0:x.data)==null?void 0:g.message)||r.message||"Ошибка авторизации. Попробуйте еще раз.";c(N),i(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:e.jsx(L,{open:!0,children:e.jsxs(R,{className:"sm:max-w-[420px]",children:[e.jsxs(A,{children:[e.jsx(I,{children:"Вход в админку"}),e.jsx(k,{children:"Введите данные администратора, чтобы открыть CMS."})]}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"email",children:"Email"}),e.jsx(j,{id:"email",type:"email",autoComplete:"username",value:p,onChange:a=>y(a.target.value),placeholder:"admin@bella.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"password",children:"Пароль"}),e.jsx(j,{id:"password",type:"password",autoComplete:"current-password",value:h,onChange:a=>w(a.target.value),placeholder:"••••••••",required:!0})]}),f?e.jsx("p",{className:"text-sm text-destructive",children:f}):null,e.jsx(E,{type:"submit",className:"w-full",disabled:l,children:l?"Вход...":"Войти"})]})]})})})};export{M as default};
