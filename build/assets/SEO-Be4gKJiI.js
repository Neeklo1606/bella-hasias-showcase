import{c as z,r as n,q as X,n as se,j as e,P as W,y as ae,M as re,D as oe,b as O,T as ie,B as w,N as E,O as R,Q as U,p as _,S as q,t as N}from"./index-C5uESbrG.js";import{L as k,I as L}from"./label-DElv73vA.js";import{m as ne,C as D,a as M,c as P,e as A,b as B}from"./media.api-DvV1X37Q.js";import{T as ce}from"./popover-BMJZbY8k.js";import{u as le,S as de}from"./index-B_gyHhaM.js";import{M as me}from"./MediaSelect-BTtvT2QE.js";import{E as I}from"./external-link-DHfrgClE.js";import{c as he}from"./cases.api-DrKrn547.js";import{u as pe}from"./use-resolved-media-DwBaVLrI.js";import"./image-CTmPK9n4.js";import"./check-B6GKJrpg.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=z("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=z("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var T="Switch",[ue]=oe(T),[xe,fe]=ue(T),Y=n.forwardRef((t,o)=>{const{__scopeSwitch:c,name:d,checked:s,defaultChecked:m,required:l,disabled:i,value:r="on",onCheckedChange:u,form:h,...x}=t,[f,v]=n.useState(null),y=X(o,p=>v(p)),j=n.useRef(!1),b=f?h||!!f.closest("form"):!0,[g,a]=se({prop:s,defaultProp:m??!1,onChange:u,caller:T});return e.jsxs(xe,{scope:c,checked:g,disabled:i,children:[e.jsx(W.button,{type:"button",role:"switch","aria-checked":g,"aria-required":l,"data-state":V(g),"data-disabled":i?"":void 0,disabled:i,value:r,...x,ref:y,onClick:ae(t.onClick,p=>{a(S=>!S),b&&(j.current=p.isPropagationStopped(),j.current||p.stopPropagation())})}),b&&e.jsx(Q,{control:f,bubbles:!j.current,name:d,value:r,checked:g,required:l,disabled:i,form:h,style:{transform:"translateX(-100%)"}})]})});Y.displayName=T;var J="SwitchThumb",K=n.forwardRef((t,o)=>{const{__scopeSwitch:c,...d}=t,s=fe(J,c);return e.jsx(W.span,{"data-state":V(s.checked),"data-disabled":s.disabled?"":void 0,...d,ref:o})});K.displayName=J;var ge="SwitchBubbleInput",Q=n.forwardRef(({__scopeSwitch:t,control:o,checked:c,bubbles:d=!0,...s},m)=>{const l=n.useRef(null),i=X(l,m),r=le(c),u=re(o);return n.useEffect(()=>{const h=l.current;if(!h)return;const x=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(x,"checked").set;if(r!==c&&v){const y=new Event("click",{bubbles:d});v.call(h,c),h.dispatchEvent(y)}},[r,c,d]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:c,...s,tabIndex:-1,ref:i,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Q.displayName=ge;function V(t){return t?"checked":"unchecked"}var Z=Y,ve=K;const ee=n.forwardRef(({className:t,...o},c)=>e.jsx(Z,{className:O("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...o,ref:c,children:e.jsx(ve,{className:O("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ee.displayName=Z.displayName;const F=60,G=160,ye=({page:t,mediaItems:o,onSave:c,publicPath:d})=>{const s=t.seo??{metaTitle:"",metaDescription:"",index:!0},[m,l]=n.useState(s.metaTitle),[i,r]=n.useState(s.metaDescription),[u,h]=n.useState(s.ogImageId??""),[x,f]=n.useState(s.index);n.useEffect(()=>{l(s.metaTitle),r(s.metaDescription),h(s.ogImageId??""),f(s.index)},[t.id,s.metaTitle,s.metaDescription,s.ogImageId,s.index]);const v=()=>{c({metaTitle:m.trim(),metaDescription:i.trim(),ogImageId:u||void 0,index:x})},y=m.length,j=i.length,b=y<=F,g=j<=G;return e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:t.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(I,{className:"mr-1 h-3 w-3"}),"На сайте"]})}),e.jsx(w,{size:"sm",onClick:v,children:"Сохранить"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{htmlFor:`metaTitle-${t.id}`,children:"Meta Title"}),e.jsxs(E,{children:[e.jsx(R,{asChild:!0,children:e.jsx($,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(U,{className:"max-w-xs",children:"Заголовок для поисковой выдачи. Рекомендуется до 60 символов."})]}),e.jsxs("span",{className:`ml-auto text-xs ${b?"text-muted-foreground":"text-destructive"}`,children:[y,"/",F]})]}),e.jsx(L,{id:`metaTitle-${t.id}`,value:m,onChange:a=>l(a.target.value),placeholder:"Заголовок страницы | Bella Hasias",className:b?"":"border-destructive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{htmlFor:`metaDesc-${t.id}`,children:"Meta Description"}),e.jsxs(E,{children:[e.jsx(R,{asChild:!0,children:e.jsx($,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(U,{className:"max-w-xs",children:"Описание для сниппета в поиске. Рекомендуется до 160 символов."})]}),e.jsxs("span",{className:`ml-auto text-xs ${g?"text-muted-foreground":"text-destructive"}`,children:[j,"/",G]})]}),e.jsx(ce,{id:`metaDesc-${t.id}`,value:i,onChange:a=>r(a.target.value),placeholder:"Краткое описание страницы для поисковых систем",rows:2,className:g?"":"border-destructive"})]}),e.jsx(me,{label:"OG Image",value:u,onChange:h,items:o,allowEmpty:!0}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{htmlFor:`index-${t.id}`,children:"Индексация"}),e.jsxs(E,{children:[e.jsx(R,{asChild:!0,children:e.jsx($,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(U,{className:"max-w-xs",children:"index — страница в поиске. noindex — не индексировать."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${x?"text-green-600":"text-amber-600"}`,children:x?"index":"noindex"}),e.jsx(ee,{id:`index-${t.id}`,checked:x,onCheckedChange:f})]})]})]})})},je="https://bellahasias.ru",be={siteUrl:je},we="cms_seo_config",te=()=>{try{const t=localStorage.getItem(we);if(t){const o=JSON.parse(t);if(o!=null&&o.siteUrl)return o}}catch{}return be},Se={home:"/",contacts:"/contacts",portfolio:"/portfolio",services:"/services"},Ne=[{path:"/services",priority:.9,changefreq:"weekly"},{path:"/portfolio",priority:.8,changefreq:"weekly"},{path:"/privacy",priority:.3,changefreq:"yearly"},{path:"/terms",priority:.3,changefreq:"yearly"},{path:"/consent",priority:.3,changefreq:"yearly"},{path:"/services/brand-styling",priority:.6,changefreq:"monthly"},{path:"/services/wardrobe-audit",priority:.6,changefreq:"monthly"},{path:"/services/personal-shopping",priority:.6,changefreq:"monthly"},{path:"/services/capsule-wardrobe",priority:.6,changefreq:"monthly"},{path:"/services/event-look",priority:.6,changefreq:"monthly"},{path:"/services/client-shoot",priority:.6,changefreq:"monthly"},{path:"/services/ugc",priority:.6,changefreq:"monthly"},{path:"/services/photo-video",priority:.6,changefreq:"monthly"},{path:"/services/ai-content",priority:.6,changefreq:"monthly"}],Ce=(t,o,c)=>{var i;const s=te().siteUrl.replace(/\/$/,""),m=r=>new Date(r).toISOString().slice(0,10),l=[];for(const r of t){if(((i=r.seo)==null?void 0:i.index)===!1)continue;const u=Se[r.slug]??`/${r.slug}`,h=m(r.updatedAt),x=r.slug==="home"?"1.0":"0.8",f=r.slug==="home"?"weekly":"monthly";l.push(`  <url>
    <loc>${s}${u}</loc>
    <lastmod>${h}</lastmod>
    <changefreq>${f}</changefreq>
    <priority>${x}</priority>
  </url>`)}for(const r of o)l.push(`  <url>
    <loc>${s}/portfolio/${r.slug}</loc>
    <lastmod>${m(r.updatedAt)}</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.7</priority>
  </url>`);for(const r of Ne)l.some(u=>u.includes(`<loc>${s}${r.path}</loc>`))||l.push(`  <url>
    <loc>${s}${r.path}</loc>
    <lastmod>${m(new Date().toISOString())}</lastmod>
    <changefreq>${r.changefreq}</changefreq>
    <priority>${r.priority}</priority>
  </url>`);return`<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
${l.join(`
`)}
</urlset>`},ke=(t,o)=>{const c=Ce(t,o),d=new Blob([c],{type:"application/xml"}),s=URL.createObjectURL(d),m=document.createElement("a");m.href=s,m.download="sitemap.xml",m.click(),URL.revokeObjectURL(s)},Te={home:"/",contacts:"/contacts",portfolio:"/portfolio",services:"/services"},Ee=(t,o)=>{var l;const d=te().siteUrl.replace(/\/$/,""),s=["/admin","/admin/"];for(const i of t)if(((l=i.seo)==null?void 0:l.index)===!1){const r=Te[i.slug]??`/${i.slug}`;r!=="/"&&s.push(r)}return["User-agent: *","Allow: /",...s.map(i=>`Disallow: ${i}`),"",`Sitemap: ${d}/sitemap.xml`,`Host: ${d}`].join(`
`)},Re=t=>{const o=Ee(t),c=new Blob([o],{type:"text/plain"}),d=URL.createObjectURL(c),s=document.createElement("a");s.href=d,s.download="robots.txt",s.click(),URL.revokeObjectURL(d)},Ue="https://search.google.com/test/rich-results",$e="https://webmaster.yandex.ru/",Fe=()=>{const[t,o]=n.useState([]),[c,d]=n.useState([]),[s,m]=n.useState(""),[l,i]=n.useState(""),[r,u]=n.useState(!0),h=n.useCallback(async()=>{try{u(!0);const[a,p,S]=await Promise.all([_.adminList({per_page:100}),ne.adminList({per_page:100}),q.adminGet()]);o(a.data),d(p.data),i(S.siteUrl)}catch(a){console.error("Failed to load SEO data:",a),N({title:"Ошибка",description:"Не удалось загрузить данные.",variant:"destructive"})}finally{u(!1)}},[]);n.useEffect(()=>{h()},[h]);const x=n.useCallback(async(a,p)=>{try{if(!t.find(C=>C.id===a))return;await _.adminUpdate(Number(a),{seo:p}),o(t.map(C=>C.id===a?{...C,seo:p}:C)),N({title:"Сохранено",description:"SEO настройки страницы обновлены."})}catch(S){console.error("Failed to save SEO:",S),N({title:"Ошибка",description:"Не удалось сохранить SEO настройки.",variant:"destructive"})}},[t]),f=async()=>{try{await q.adminUpdate({siteUrl:l.trim()||"https://bellahasias.ru"}),N({title:"Сохранено",description:"URL сайта обновлён."})}catch(a){console.error("Failed to save site URL:",a),N({title:"Ошибка",description:"Не удалось сохранить URL сайта.",variant:"destructive"})}},v=async()=>{try{const a=await he.adminList({per_page:100});ke(t,a.data)}catch(a){console.error("Failed to load cases for sitemap:",a),N({title:"Ошибка",description:"Не удалось загрузить кейсы для sitemap.",variant:"destructive"})}},y=()=>{Re(t)},j=pe(c),b=n.useMemo(()=>{if(!s.trim())return t;const a=s.trim().toLowerCase();return t.filter(p=>p.title.toLowerCase().includes(a)||p.slug.toLowerCase().includes(a))},[t,s]),g=a=>a.slug==="home"?"/":`/${a.slug}`;return r?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Загрузка..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"SEO"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Мета-информация страниц, sitemap и robots.txt"})]}),e.jsxs(D,{children:[e.jsxs(M,{children:[e.jsx(P,{children:"URL сайта"}),e.jsx(A,{children:"Базовый URL для sitemap.xml и robots.txt"})]}),e.jsxs(B,{className:"flex flex-col gap-4 sm:flex-row sm:items-end",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(k,{htmlFor:"siteUrl",children:"Site URL"}),e.jsx(L,{id:"siteUrl",value:l,onChange:a=>i(a.target.value),placeholder:"https://your-site.com"})]}),e.jsx(w,{onClick:f,children:"Сохранить"})]})]}),e.jsxs(D,{children:[e.jsxs(M,{children:[e.jsx(P,{children:"Генерация файлов"}),e.jsx(A,{children:"Скачайте sitemap.xml и robots.txt и поместите в папку public/"})]}),e.jsxs(B,{className:"flex flex-wrap gap-4",children:[e.jsxs(w,{variant:"outline",onClick:v,children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Скачать sitemap.xml"]}),e.jsxs(w,{variant:"outline",onClick:y,children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Скачать robots.txt"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(de,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(L,{placeholder:"Поиск по странице...",value:s,onChange:a=>m(a.target.value),className:"pl-9 max-w-md"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:Ue,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(I,{className:"mr-1 h-3 w-3"}),"Google Rich Results"]})}),e.jsx(w,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:$e,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(I,{className:"mr-1 h-3 w-3"}),"Яндекс Вебмастер"]})})]})]}),e.jsx("div",{className:"space-y-4",children:b.map(a=>e.jsx(ye,{page:a,mediaItems:j,onSave:p=>x(a.id,p),publicPath:g(a)},a.id))}),b.length===0&&e.jsx("p",{className:"py-8 text-center text-sm text-muted-foreground",children:t.length===0?"Нет страниц. Добавьте страницы в разделе Страницы.":"Нет результатов по поиску."})]})};export{Fe as default};
