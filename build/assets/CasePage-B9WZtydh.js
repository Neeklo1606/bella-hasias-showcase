import{ae as h,g as d,j as e,L as c,ac as g,ad as f,d as j,s as b}from"./index-ClYFeCvH.js";import{u as v}from"./use-resolved-media-BkLiug_3.js";import{A as n}from"./arrow-left-c11-TTcR.js";import{I as N}from"./image-xXvm16Yd.js";const y=r=>/\.(mp4|webm)$/i.test(r)||r.startsWith("data:video/")||r.startsWith("http")&&/\.(mp4|webm)/i.test(r),F=()=>{const{slug:r}=h(),{data:t,isLoading:o,isError:m}=d({queryKey:["case","public",r],queryFn:()=>{if(!r)throw new Error("Slug не указан");return j.getBySlug(r)},enabled:!!r,refetchOnWindowFocus:!1,retry:1}),{data:a}=d({queryKey:["services","public",{per_page:100}],queryFn:()=>b.list({per_page:100}),refetchOnWindowFocus:!1,retry:1,enabled:!!(t!=null&&t.serviceId)}),i=t!=null&&t.serviceId&&(a!=null&&a.data)?a.data.find(s=>s.id===t.serviceId):null,x=t?(t.media||[]).map(s=>({id:String(s.id),filename:s.filename,src:s.url||s.src,category:s.category||"Прочее",alt:s.alt||"",createdAt:s.createdAt||new Date().toISOString()})):[],u=v(x),p=new Map(u.map(s=>[s.id,s]));if(o)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Загрузка..."})});if(m||!t)return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center px-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Кейс не найден"}),e.jsxs(c,{to:"/portfolio",className:"mt-4 text-primary hover:underline flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),"Назад к портфолио"]})]});const l=t.mediaIds.map(s=>p.get(s)).filter(Boolean);return e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsxs("title",{children:[t.title," — Bella Hasias | Портфолио"]}),e.jsx("meta",{name:"description",content:t.description.slice(0,160)})]}),e.jsxs("main",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"mx-auto max-w-4xl px-4 py-12 md:px-6",children:[e.jsxs(c,{to:"/portfolio",className:"mb-8 inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(n,{className:"h-4 w-4"}),"Назад к портфолио"]}),e.jsxs("header",{className:"mb-10",children:[i&&e.jsx("p",{className:"text-sm font-medium text-primary mb-2",children:i.title}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight md:text-4xl",children:t.title}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:t.tags.map(s=>e.jsx("span",{className:"rounded-full bg-secondary px-3 py-1 text-sm text-muted-foreground",children:s},s))})]}),t.description&&e.jsx("div",{className:"prose prose-neutral dark:prose-invert max-w-none mb-12",children:e.jsx("p",{className:"whitespace-pre-wrap text-muted-foreground leading-relaxed",children:t.description})}),e.jsxs("section",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Галерея"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:l.map(s=>e.jsx("div",{className:"overflow-hidden rounded-2xl bg-muted aspect-[4/3]",children:y(s.src)?e.jsx("video",{src:s.src,controls:!0,className:"h-full w-full object-cover"}):e.jsx("img",{src:s.src,alt:s.alt||t.title,className:"h-full w-full object-cover"})},s.id))}),l.length===0&&e.jsx("div",{className:"flex aspect-video items-center justify-center rounded-2xl border border-dashed bg-muted/30",children:e.jsx(N,{className:"h-16 w-16 text-muted-foreground/50"})})]})]}),e.jsx(f,{})]})]})};export{F as default};
