import{u as S,a as C,r as s,j as e,B as E}from"./index-CJN8wZ_c.js";import{D as L,a as R,b as A,c as I,d as k,I as j}from"./input-Beno2FK0.js";import{L as b}from"./label-C1L8DSrz.js";const M=()=>{const l=S(),{login:v,isAuthenticated:u,isAdmin:d,isReady:m}=C(),i=s.useRef(!1),o=s.useRef(!1),[p,y]=s.useState(""),[h,w]=s.useState(""),[x,c]=s.useState(null),[r,n]=s.useState(!1);s.useEffect(()=>{o.current||i.current||m&&u&&d&&!r&&(i.current=!0,l("/admin/dashboard",{replace:!0}))},[u,d,m,r,l]);const D=async a=>{var f,g;a.preventDefault(),c(null),n(!0),o.current=!1;try{const t=await v(p.trim(),h);if(!t.ok){c(t.error??"Ошибка авторизации."),n(!1);return}o.current=!0,n(!1),setTimeout(()=>{i.current=!0,l("/admin/dashboard",{replace:!0})},100)}catch(t){const N=((g=(f=t.response)==null?void 0:f.data)==null?void 0:g.message)||t.message||"Ошибка авторизации. Попробуйте еще раз.";c(N),n(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:e.jsx(L,{open:!0,children:e.jsxs(R,{className:"sm:max-w-[420px]",children:[e.jsxs(A,{children:[e.jsx(I,{children:"Вход в админку"}),e.jsx(k,{children:"Введите данные администратора, чтобы открыть CMS."})]}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"email",children:"Email"}),e.jsx(j,{id:"email",type:"email",autoComplete:"username",value:p,onChange:a=>y(a.target.value),placeholder:"admin@bella.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"password",children:"Пароль"}),e.jsx(j,{id:"password",type:"password",autoComplete:"current-password",value:h,onChange:a=>w(a.target.value),placeholder:"••••••••",required:!0})]}),x?e.jsx("p",{className:"text-sm text-destructive",children:x}):null,e.jsx(E,{type:"submit",className:"w-full",disabled:r,children:r?"Вход...":"Войти"})]})]})})})};export{M as default};
